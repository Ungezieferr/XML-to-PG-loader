# XML to SQL Database loader

Пакет для загрузки данных из XML файла в базу данных. 
Реализация для СУБД PostgresSQL.

______________

## Общая информация
Для корректной работы необходимо соблюдать следующие далее ограничения.
### Формат данных в XML файле
```bash
<data>
    <animals>
        <species>vulpes</species>
        <family>canidae</family>
        <class>mammalia</class>
        <conservationstatus>LC</conservationstatus>
    </animals>
</data>
```
- Данные для каждой колонки должны быть помещены в тег с названием этой колонки. 
- В свою очередь, данные строки обрамляются тегов с названием таблицы. 
- Заглавные буквы в тегах могут привести к ошибке вставки данных вследствие несовпадения наименований.


> Должны совпадать имя тега и соответствующей колонки в таблице, обязателен нижний регистр.

### Ограничение таблицы SQL
Для избежания получения в таблице дубликатов данных необходимо добавить Constraits unique. Поля из этого ограничения
необходимо обозначить функцией addConflictStat().
_________________
  
# XML utils

Пакет классов для чтения данных из файла.

## Класс TableRow
Класс-контейнер для строк данных. 
Обладает одним пустым конструктором.
###Публичные поля

- ####setByTag(String tag, Object data)

Данная функция позволяет добавить данные в HashMap. 
В случае повтора тега (ключа) данные обновляются.
Возвращаемого значения не имеет.

- ####getByTag(String key)
Возвращает значение по ключу из HashMap.



##Класс XMLReader
Данный класс обрабатывает файл XML, оформленный по указанному ранее примеру, помещая данные в 
экземпляры класса TableRow.

Конструктор принимает путь к файлу данных и название целевой таблицы.

Реализована защита от хранения дублирующих строк, посредством хранения последних в HashSet.

###Публичные поля
- ####nextRow()
Возвращает следующий экземпляр класса TableRow, в случае, если элементы закончились, возвращает null.
____________
#SQL utils
Пакет, регулирующий взаимодействие базы данных и, собственно, данных предназначенных для внесения в неё.
##Класс Column
Обладает одним конструктором, принимающим на вход имя и SQL тип данных.
###Публичные поля

 - name 
   
Название колонки

- addParametr(int index, PreparedStatement st, Object value) 

Метод предназначен для помещения в подготовленную строку данных, с учётом типа колонки к которой они относятся.


##Класс XMLtoSQLloader
Абстрактный класс загрузчика данных в бд.
Содержит реализацию метода 
- ####addColumn(String name, SQLType tp)
Добавляет колонку таблице с указанным именем и типом данных.

##Класс XMLtoPGloader
Класс-наследник XMLtoSQLloader, реализующий функции для загрузки данных в PostgresSQL.

Обладает одним конструктором, принимающим данные для подключения к базе данных.

###Публичные методы

- ####setTableName(String name)
Устанавливает имя целевой таблицы.
>Необходимо сообщить имя таблицы до внесения пути к файлу данных.

- ####setDataFile(String filename)
Совершает попытку открыть файл и считать данные. В случае успеха возвращает 0, иначе 1.

- ####addConflictStat(String stateName)
Вносит указанное имя в массив полей, что должны образовывать уникальное сочетание в каждой строчке. 
Необходимо для избежания дублей.

- ####setUpdateAction(String sqlStateFromDoUpdate)

Позволяет установить действие, которое выполняет субд при возникновении конфликта вставки данных.

> - Начать входную строку следует с DO UPDATE.
> - Если не установить данное действие, при конфликте новые данные будут отбрасываться.

- ####uploadData()
При вызове производится попытка подключения к бд и, в случае успеха, загрузка данных.
Возвращает количество вставленных строк.